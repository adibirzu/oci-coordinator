# OCI AI Agent Coordinator - Environment Configuration
# Copy this file to .env.local and fill in your values
# .env.local is gitignored and safe for secrets

# ═══════════════════════════════════════════════════════════════════════════════
# OCI Configuration
# ═══════════════════════════════════════════════════════════════════════════════
OCI_CONFIG_FILE=~/.oci/config
OCI_CLI_PROFILE=DEFAULT
# OCI_REGION=us-ashburn-1

# ═══════════════════════════════════════════════════════════════════════════════
# LLM Provider Configuration
# ═══════════════════════════════════════════════════════════════════════════════
# Options: oca, anthropic, openai, oci_genai, lm_studio, ollama
LLM_PROVIDER=oca

# LLM Fallback Priority (optional - comma-separated list)
# If configured provider is unavailable, system falls back to next available
# Default priority: lm_studio,ollama,oca,oci_genai,anthropic,openai
# LLM_PROVIDER_PRIORITY=lm_studio,ollama,oca,anthropic

# Optional channel-specific overrides (e.g., Slack vs API)
# LLM_PROVIDER_SLACK=oracle_code_assist
# OCA_MODEL_SLACK=oca/gpt5.2
# LLM_PROVIDER_API=anthropic
# ANTHROPIC_MODEL_API=claude-sonnet-4-20250514

# Oracle Code Assist (OCA) - Primary LLM
OCA_MODEL=oca/gpt5.2
OCA_CALLBACK_HOST=127.0.0.1
OCA_CALLBACK_PORT=48803

# Alternative: Anthropic Claude
# LLM_PROVIDER=anthropic
# ANTHROPIC_API_KEY=sk-ant-xxx
# ANTHROPIC_MODEL=claude-sonnet-4-20250514

# Alternative: OpenAI
# LLM_PROVIDER=openai
# OPENAI_API_KEY=sk-xxx
# OPENAI_MODEL=gpt-4o-mini

# Alternative: OCI GenAI
# LLM_PROVIDER=oci_genai
# OCI_GENAI_COMPARTMENT_ID=ocid1.compartment.oc1..xxx
# OCI_GENAI_MODEL_ID=cohere.command-r-plus
# OCI_GENAI_ENDPOINT=https://inference.generativeai.us-chicago-1.oci.oraclecloud.com

# Alternative: LM Studio (local)
# LLM_PROVIDER=lm_studio
# LM_STUDIO_BASE_URL=http://localhost:1234/v1
# LM_STUDIO_MODEL=local-model

# Alternative: Ollama (local)
# LLM_PROVIDER=ollama
# OLLAMA_BASE_URL=http://localhost:11434/v1
# OLLAMA_MODEL=llama3.1

# ═══════════════════════════════════════════════════════════════════════════════
# Slack Integration (Socket Mode)
# ═══════════════════════════════════════════════════════════════════════════════
SLACK_BOT_TOKEN=xoxb-xxx
SLACK_APP_TOKEN=xapp-xxx
SLACK_SIGNING_SECRET=xxx

# Enable LangGraph coordinator for Slack routing (default: true)
USE_LANGGRAPH_COORDINATOR=true

# Coordinator timeout for high-latency LLM providers (default: 300s)
# Increase if using cross-region OCA (US-EMEA adds ~15-20s per LLM call)
# SLACK_COORDINATOR_TIMEOUT_SECONDS=300

# ═══════════════════════════════════════════════════════════════════════════════
# OCI APM (OpenTelemetry Tracing + Log Correlation)
# ═══════════════════════════════════════════════════════════════════════════════
OCI_APM_ENDPOINT=https://xxx.apm-agt.region.oci.oraclecloud.com
OCI_APM_PRIVATE_DATA_KEY=xxx
OTEL_SERVICE_NAME=oci-coordinator-agent

# OTLP Log Export: sends logs to APM for span-level correlation
# Logs appear in APM span details "Logs" tab alongside traces
# Uses same endpoint/key as tracing - enabled automatically when tracing is enabled
# Set minimum log level for OTLP export (default: INFO)
# OTLP_LOG_LEVEL=INFO

# ═══════════════════════════════════════════════════════════════════════════════
# OCI Logging (Per-Agent Logs with Trace Correlation)
# ═══════════════════════════════════════════════════════════════════════════════
OCI_LOG_GROUP_ID=ocid1.loggroup.oc1.region.xxx
OCI_LOG_ID_COORDINATOR=ocid1.log.oc1.region.xxx
OCI_LOG_ID_DB_TROUBLESHOOT=ocid1.log.oc1.region.xxx
OCI_LOG_ID_LOG_ANALYTICS=ocid1.log.oc1.region.xxx
OCI_LOG_ID_SECURITY_THREAT=ocid1.log.oc1.region.xxx
OCI_LOG_ID_FINOPS=ocid1.log.oc1.region.xxx
OCI_LOG_ID_INFRASTRUCTURE=ocid1.log.oc1.region.xxx
OCI_LOGGING_REGION=eu-frankfurt-1
OCI_LOGGING_ENABLED=true

# ═══════════════════════════════════════════════════════════════════════════════
# ShowOCI Resource Discovery & Caching
# ═══════════════════════════════════════════════════════════════════════════════
SHOWOCI_CACHE_ENABLED=false
OCI_PROFILES=DEFAULT
SHOWOCI_REFRESH_HOURS=4

# ═══════════════════════════════════════════════════════════════════════════════
# Redis (Hot Cache)
# ═══════════════════════════════════════════════════════════════════════════════
REDIS_URL=redis://localhost:6379
# REDIS_PASSWORD=

# ═══════════════════════════════════════════════════════════════════════════════
# API Server Configuration
# ═══════════════════════════════════════════════════════════════════════════════
API_HOST=0.0.0.0
API_PORT=3003

# ═══════════════════════════════════════════════════════════════════════════════
# MCP Server Paths (configured in config/mcp_servers.yaml)
# ═══════════════════════════════════════════════════════════════════════════════
# Optional override for deployment-specific MCP config (e.g., OKE profile):
# MCP_CONFIG_FILE=/app/config/mcp_servers.oke.yaml
#
# MCP Gateway (recommended for OCI runtime)
# Set MCP_GATEWAY_ENABLED=true to route coordinator traffic via gateway endpoint
# MCP_GATEWAY_ENABLED=true
# MCP_GATEWAY_URL=http://127.0.0.1:9000/mcp
# MCP_GATEWAY_BEARER_TOKEN=replace-with-gateway-token
# MCP_PROTOCOL_VERSION=2025-11-05

# Database Observatory MCP Server
MCP_DATABASE_OBSERVATORY_PATH=/path/to/mcp-oci-database-observatory

# FinOps AI MCP Server
MCP_FINOPSAI_PATH=/path/to/finopsai-mcp

# OCI Infrastructure MCP Server (mcp-oci)
MCP_OCI_PATH=/path/to/mcp-oci

# Security MCP Server
MCP_SECURITY_PATH=/path/to/oci-mcp-security

# SQLcl path for database connections
SQLCL_PATH=/Applications/sqlcl/bin/sql

# OCI auth mode for built-in MCP tools:
# - api_key (default, uses ~/.oci/config profile)
# - resource_principal
# - instance_principal
# - oke_workload_identity
# OCI_CLI_AUTH=api_key

# ═══════════════════════════════════════════════════════════════════════════════
# ATP Connection (Wallet-based) - Preferred for SelectAI
# ═══════════════════════════════════════════════════════════════════════════════
# TNS alias from your wallet's tnsnames.ora (e.g., dbname_high, dbname_medium)
# ATP_TNS_NAME=a4pc80h5cx6ehrmb_high

# Database user (usually ADMIN for SelectAI)
# ATP_USER=ADMIN

# Database password
# ATP_PASSWORD=YourPassword

# Path to the wallet directory (contains tnsnames.ora, cwallet.sso, etc.)
# ATP_WALLET_DIR=/path/to/Wallet_DBNAME

# Wallet password (optional, only needed if using ewallet.pem)
# ATP_WALLET_PASSWORD=YourWalletPassword

# ═══════════════════════════════════════════════════════════════════════════════
# SelectAI Configuration (Natural Language to SQL)
# ═══════════════════════════════════════════════════════════════════════════════
# Default AI profile name (must be created in the database)
# SELECTAI_DEFAULT_PROFILE=OCI_GENAI

# OCI Compartment ID for SelectAI profile creation (used by provision_selectai.py)
# Required for OCI GenAI access via resource principal
# OCI_COMPARTMENT_ID=ocid1.compartment.oc1..xxx

# NOTE: SelectAI uses meta.llama-3.1-405b-instruct model by default
# This model is available in eu-frankfurt-1 to avoid cross-region routing issues
# The database must have a dynamic group and policy for GenAI access:
#   allow dynamic-group <name> to use generative-ai-family in tenancy

# Alternative connection via ORDS REST API (fallback if wallet not configured)
# ORDS base URL for Autonomous Database
# Get this from your ADB console: Database Actions → RESTful Services
# SELECTAI_ORDS_BASE_URL=https://xxx.adb.region.oraclecloudapps.com

# ORDS schema (default: ADMIN)
# SELECTAI_ORDS_SCHEMA=ADMIN

# ORDS OAuth token (for authenticated access)
# SELECTAI_ORDS_AUTH_TOKEN=xxx

# ═══════════════════════════════════════════════════════════════════════════════
# LangSmith (Optional - Development Tracing)
# ═══════════════════════════════════════════════════════════════════════════════
# LANGSMITH_TRACING=true
# LANGSMITH_API_KEY=xxx
# LANGSMITH_PROJECT=oci-coordinator

# ═══════════════════════════════════════════════════════════════════════════════
# Development Settings
# ═══════════════════════════════════════════════════════════════════════════════
LOG_LEVEL=INFO
DEBUG=false
# DEBUG_MCP=true

# Runtime deployment mode for agent capability/server adaptation:
# - local (developer machine, direct servers preferred)
# - cloud (gateway-first with direct fallback)
# - oke (strict gateway-only)
# - oci-demo (gateway-first with federated backends)
# OCI_DEPLOYMENT_MODE=local

# ═══════════════════════════════════════════════════════════════════════════════
# Safety / Mutations
# ═══════════════════════════════════════════════════════════════════════════════
# Enable write operations for mutation-tier tools (default: false)
ALLOW_MUTATIONS=false

# Enable automatic security remediation (requires ALLOW_MUTATIONS=true)
SECURITY_AUTO_REMEDIATE=false

# ═══════════════════════════════════════════════════════════════════════════════
# Multi-Profile Database Management Configuration
# ═══════════════════════════════════════════════════════════════════════════════
# For multi-tenancy setups, configure compartments and regions per profile.
# The list_databases workflow queries these to discover databases across profiles.
#
# DEFAULT profile (uses OCI_CLI_PROFILE or DEFAULT from ~/.oci/config)
# OCI_DEFAULT_TENANCY_ID=ocid1.tenancy.oc1..xxx
# OCI_DEFAULT_DBMGMT_COMPARTMENT_ID=ocid1.compartment.oc1..xxx
# OCI_DEFAULT_DBMGMT_REGION=us-ashburn-1
# OCI_DEFAULT_OPSI_COMPARTMENT_ID=ocid1.compartment.oc1..xxx
# OCI_DEFAULT_OPSI_REGION=us-ashburn-1
#
# EMDEMO profile (for Enterprise Manager demo tenancy)
# OCI_EMDEMO_TENANCY_ID=ocid1.tenancy.oc1..xxx
# OCI_EMDEMO_DBMGMT_COMPARTMENT_ID=ocid1.compartment.oc1..xxx
# OCI_EMDEMO_DBMGMT_REGION=us-ashburn-1
# OCI_EMDEMO_OPSI_COMPARTMENT_ID=ocid1.compartment.oc1..xxx
# OCI_EMDEMO_OPSI_REGION=uk-london-1
# OCI_EMDEMO_LOGAN_COMPARTMENT_ID=ocid1.compartment.oc1..xxx
# OCI_EMDEMO_LOGAN_REGION=uk-london-1

# ═══════════════════════════════════════════════════════════════════════════════
# Infrastructure Provisioning Defaults
# ═══════════════════════════════════════════════════════════════════════════════
# These are required for the "create instance" / "provision vm" workflow
# Get these values from your OCI console or CLI

# Default compartment for resource creation (fallback to tenancy root if not set)
# DEFAULT_COMPARTMENT_ID=ocid1.compartment.oc1..xxx

# Availability domain for compute instances (required for provisioning)
# Example: Uocm:EU-FRANKFURT-1-AD-1
# DEFAULT_AVAILABILITY_DOMAIN=

# Subnet OCID for instance network configuration (required for provisioning)
# DEFAULT_SUBNET_ID=ocid1.subnet.oc1.xxx

# SSH public key for instance access (optional, but recommended)
# SSH_PUBLIC_KEY=ssh-rsa AAAAB3...

# ═══════════════════════════════════════════════════════════════════════════════
# Slack Formatting (Optional)
# ═══════════════════════════════════════════════════════════════════════════════
# Table formatting limits for Slack messages
# SLACK_TABLE_MAX_ROWS=15
# SLACK_TABLE_CHAR_LIMIT=2800
# SLACK_TABLE_CELL_CHARS=30
# SLACK_TABLE_FALLBACK_ROWS=5

# ═══════════════════════════════════════════════════════════════════════════════
# Advanced Settings (Optional)
# ═══════════════════════════════════════════════════════════════════════════════
# Context history timeout in seconds (default: 3600)
# CONTEXT_HISTORY_TIMEOUT_SECONDS=3600

# Enable LLM rate limiting
# LLM_RATE_LIMITING=true

# MCP Redis URL (separate from main Redis, if needed)
# MCP_REDIS_URL=redis://localhost:6379

# OCA response cache directory
# OCA_CACHE_DIR=~/.cache/oca
